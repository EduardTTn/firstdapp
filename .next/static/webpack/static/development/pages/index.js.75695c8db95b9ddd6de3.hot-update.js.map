{"version":3,"file":"static/webpack/static/development/pages/index.js.75695c8db95b9ddd6de3.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["import React, {Component} from 'react';\nimport instance from '../components/carrecord.js';\nimport Card from \"semantic-ui-react/dist/commonjs/views/Card\";\nimport {Button, Container, Dropdown, Form, Icon, Image, Menu, Loader, Message, Table} from 'semantic-ui-react'\nimport Head from \"next/head\";\nimport FixedMenuLayout from \"../components/footer\";\nimport Link from 'next/link';\nimport web3 from '../components/web3';\nimport SimpleSnackbar from \"../components/snackbar\";\n\nclass Index extends Component {\n\n    componentWillMount(){\n        this.loadBlockchainData()\n    }\n\n    async loadBlockchainData() {\n        let accounts = await web3.eth.getAccounts();\n        this.setState({isOwner: await instance.methods.checkIfOwner(accounts[0]).call()});\n        this.setState({isAdmin: await instance.methods.checkIfAdmin(accounts[0]).call()});\n\n    }\n\n\n    constructor(props) {\n        super(props);\n    this.state = {\n        VIN: '',\n        car: null,\n        eventsCount: '',\n        events: [],\n        disableEventButton: true,\n        loading: false,\n        errorMessage: '',\n        showTable: false,\n        accounts: [],\n        isOwner: false,\n        isAdmin: false\n\n    };\n}\n\n\n    onClick = async event => {\n\n        event.preventDefault();\n        const {VIN} = this.state;\n        this.setState({disableEventButton: true});\n\n        this.setState({loading: true, errorMessage: ''});\n\n        try {\n            const y = await instance.methods.getEventsCount(VIN).call();\n            for (let i = 0; i < y; i++) {\n                const z = await instance.methods.getEvent(VIN, i).call();\n                this.setState({events: [...this.state.events, z]});\n\n            }\n\n            this.setState({showTable: true});\n\n\n        } catch (err) {\n            this.setState({errorMessage: err.message});\n\n        }\n        this.setState({loading: false});\n    };\n\n    renderEvents() {\n        const x = this.state.VIN;\n\n            let r =this.state.events.map(function (event) {\n                return ([\n                    <Table.Row>\n                        <Table.Cell\n                            key={x}>{event[0].toString()}/{event[1].toString()}/{event[2].toString()}</Table.Cell>\n                        <Table.Cell key={x}>{event[3].toString()}</Table.Cell>\n                        <Table.Cell key={x}>{event[4].toString()}</Table.Cell>\n                        <Table.Cell key={x}>{event[5].toString()}</Table.Cell>\n                        <Table.Cell key={x}>{event[6].toString()}</Table.Cell>\n                    </Table.Row>\n\n                ]);\n            });\n            return r;\n        }\n\n\n    renderTables() {\n\n        let tableStyle = {\n            width: '68%',\n            margin: '20px auto'\n        };\n    if (this.state.events && this.state.events.length) {\n        return (<Table celled style={tableStyle} color={'purple'} key={'purple'} inverted>\n                <Table.Header>\n                    <Table.Row>\n                        <Table.HeaderCell>Date</Table.HeaderCell>\n                        <Table.HeaderCell>Type</Table.HeaderCell>\n                        <Table.HeaderCell>Mileage</Table.HeaderCell>\n                        <Table.HeaderCell>Description</Table.HeaderCell>\n                        <Table.HeaderCell>Made by</Table.HeaderCell>\n                    </Table.Row>\n                </Table.Header>\n                <Table.Body>\n                    {this.state.disableEventButton === false ? null : this.renderEvents()}\n                </Table.Body>\n            </Table>\n        );\n    }\n    else {\n            return <Message info style={{width: '15%', margin: '30px auto'}}> This car has no events recorded </Message>\n        }\n    }\n\n\n    onSubmit = async event => {\n        event.preventDefault();\n        const {VIN} = this.state;\n        this.setState({loading: true, errorMessage: ''});\n        this.setState({disableEventButton: false});\n        this.setState({showTable: false});\n        this.setState({events: []});\n\n\n        try {\n            const x = await instance.methods.getCar(VIN).call();\n            if (x[0] === \"\") {\n                this.setState({errorMessage: 'INVALID CAR'});\n            }\n            const g = this.state.VIN;\n            if (g === '') {\n                this.setState({errorMessage: 'Field is empty'});\n            }\n            // set state.car to x only if there are valid values in X\n            if (x[0] !== '' && x[2] !== '' && x[3] !== '') {\n                this.setState({car: x});\n            }\n\n        } catch (err) {\n            this.setState({errorMessage: err.message});\n        }\n        this.setState({loading: false});\n    };\n\n    handleChange = event => {\n        event.preventDefault();\n        this.setState({showTable: false});\n        this.setState({VIN: event.target.value});\n        this.setState({errorMessage: ''});\n        this.setState({hideEvents: true});\n        this.setState({car: null});\n    };\n\n\n    render() {\n        let cardStyle = {\n            display: 'block',\n            width: '28%',\n            margin: '7px auto',\n            height: 'auto',\n        };\n\n        let formStyle = {\n            width: '100%',\n        };\n\n        console.log(this.state.isOwner);\n\n\n        return (\n            <div>\n                <div>\n                    <Menu fixed='top' inverted>\n                        <Container>\n                            <Link href=\"/index\">\n                                <Menu.Item as='a' header>\n                                    <Image size='normal' src='https://img.icons8.com/cotton/50/000000/retro-car.png'\n                                           style={{marginLeft: '1.5em'}}/>\n                                    <h2>Car Record</h2>\n                                </Menu.Item>\n                            </Link>\n                            {this.state.isOwner === false ? null :\n                            <Menu.Item><Link href=\"/ManageAdmin\">Manage Admin</Link></Menu.Item>\n                            }\n                            {this.state.isAdmin === false ? null :\n                                <Dropdown item simple text='Manage Cars' disabled={this.props.admin}>\n                                    <Dropdown.Menu>\n                                        <Link href=\"/AddCar\">\n                                            <Dropdown.Item as='a'>Add Car</Dropdown.Item>\n                                        </Link>\n                                        <Link href=\"/ModifyCar\">\n                                            <Dropdown.Item as='a'>Modify Car</Dropdown.Item>\n                                        </Link>\n                                        <Link href=\"/AddEvent\">\n                                            <Dropdown.Item as='a'>Add Event</Dropdown.Item>\n                                        </Link>\n                                        }\n\n\n                                    </Dropdown.Menu>\n                                </Dropdown>\n                            }\n\n                        </Container>\n\n                    </Menu>\n                </div>\n                <Head>\n                    <link\n                        rel=\"stylesheet\"\n                        href=\"//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.11/semantic.min.css\"\n                    />\n                    <style>{`\n        body {\n         background: url(\"https://images.pexels.com/photos/707047/pexels-photo-707047.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=1280&w=1900\");\n         background-repeat: no-repeat;\n         background-position: center; \n        }\n      `}</style>\n                </Head>\n\n\n                <h1 style={{margin: '20px'}}>Car Info</h1>\n                <Form className={\"form-inline\"} style={formStyle} onSubmit={this.onSubmit}\n                      error={!!this.state.errorMessage}>\n\n                    <Form.Group inline style={{width: '60%', margin: '150px auto'}}>\n                        <label style={{fontSize: 'xx-large'}}>Search:</label>\n                        <Form.Field style={{width: '90%'}}>\n                            <Form.Input placeholder=\"VIN\"\n                                   aria-placeholder={{color: 'blue'}}\n                                   style={{width: '100%', height: '75px', fontSize: 'large',}}\n                                   value={this.state.VIN}\n                                   onChange={this.handleChange}\n                                   error={!!this.state.errorMessage}\n                            />\n                        </Form.Field>\n                        <Form.Field>\n                            <Button onClick={this.onSubmit}\n                                    color={\"purple\"}\n                                    style={{width: '150px', height: '75px'}}>\n                                <Icon color='black' name='search'/>\n                            </Button>\n                        </Form.Field>\n                    </Form.Group>\n                    <Message style={{width: '15%', margin: '30px auto'}} error header={\"Error!\"} content={this.state.errorMessage}/>\n                </Form>\n                {(this.state.car != null && this.state.car[0] != null) ? (\n                    <Card style={cardStyle}>\n                        <Card.Content>\n                            <Card.Header> BRAND: </Card.Header>\n                            <Card.Description>{this.state.car[0]}</Card.Description>\n                            <Card.Header>YEAR:</Card.Header>\n                            <Card.Description>{parseInt(this.state.car[1]) >= 1 ? parseInt(this.state.car[1]) : ''}</Card.Description>\n                            <Card.Header>COLOR:</Card.Header>\n                            <Card.Description>{this.state.car[2]}</Card.Description>\n                            <Card.Header>LICENSE:</Card.Header>\n                            <Card.Description>{this.state.car[3]}</Card.Description>\n\n                        </Card.Content>\n                        <Button loading={!!this.state.loading} style={cardStyle} variant=\"contained\" color=\"purple\"\n                                disabled={this.state.disableEventButton === true || this.state.errorMessage !== ''}\n                                onClick={this.onClick}\n                                error={!!this.state.errorMessage}>\n                            Show Events\n                        </Button>\n                    </Card>\n                ) : null}\n                {this.state.showTable === true ? this.renderTables() : null}\n                <FixedMenuLayout/>\n                <div>{this.state.loading === true ? <SimpleSnackbar/> : null}</div>\n            </div>\n\n        );\n    }\n}\n\nexport default Index;"],"mappings":"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","sourceRoot":""}